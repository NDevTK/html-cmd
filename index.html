<!DOCTYPE html>
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Administrator: Command Prompt</title>
<style>
body {
  font-family: Consolas,monaco,monospace; 
  background-color: black;
  color: white;
  font-size: 16;
  border: 0;
  outline: none;
}
</style>
</head>
<body>
<a id="output">Microsoft Windows [Version 10.0.17763.504]<br>(c) 2018 Microsoft Corporation. All rights reserved.<br></a>
<div id="command">
<br><label>C:\WINDOWS\system32\&gt;</label><a style="white-space:pre" id="input"></a><a>
</a></div>

<script>
var help = new Map();
var commands = new Map();
var colors = new Map();
var hcount = 0;
var hdata = [];

function IsTouch() {
    var match = window.matchMedia || window.msMatchMedia;
    if(match) {
        var mq = match("(pointer:coarse)");
        return mq.matches;
    }
    return false;
}

function history(down) {
    if(hdata.length < 1) return;
    if (down) {
        if (hcount > 1) {	
            hcount -= 1;
	    input.innerText = hdata[hdata.length - hcount];
        }
    } else {
        if (hdata.length > hcount) {
            hcount += 1;
            input.innerText = hdata[hdata.length - hcount];
        }	
    }
   
}

colors.set('0', 'Black')
    .set('1', 'Blue')
    .set('2', 'Green')
    .set('3', 'Aqua')
    .set('4', 'Red')
    .set('5', 'Purple')
    .set('6', 'Yellow')
    .set('7', 'White')
    .set('8', 'Gray')
    .set('9', 'LightBlue')
    .set('a', 'LightGreen')
    .set('b', 'Aqua')
    .set('c', 'LightRed')
    .set('d', 'LightPurple')
    .set('e', 'LightYellow')
    .set('f', 'White')

function LowerCase(array){
for(var i = 0; i < array.length; i++) {
    array[i] = array[i].toLowerCase()
}
return array
}

function ColorParser(codes) {
    codes = LowerCase(codes);
    if (colors.has(codes[1])) {
        document.body.style.color = colors.get(codes[1]);
    }
    if (color.has(colors[2])) {
        document.body.style.backgroundColor = colors.get(colors[2]);
    }
}

function getDisplayable(args, silce){
    return args.slice(silce).join(" ");
}

command = document.getElementById("command")
output = document.getElementById("output");
input = document.getElementById("input");

if(IsTouch){
input.isContentEditable = true;
command.addEventListener('ontouchend', function(e) {
    input.focus();
});
}

function echo(line) {
    output.innerText += line;
}

function NL(){
    output.innerText += "\n";
}

document.addEventListener('keydown', function(e) {

    if (e.key.length === 1) {
        input.innerText += e.key;
        return
    }
    txt = command.innerText.trim();
    switch (e.code) {
        case "Enter":
            NL();
            echo(txt);
	    NL()
            responce = process(txt);
            if(responce) {
	        echo(responce);
		NL()
	    }else{
	        NL();
	    }
            hdata.push(input.innerText);
            input.innerText = "";
            break;
        case "Backspace":
            input.innerText = input.innerText.slice(0, -1);
            break;
        case "Space":
            input.innerText += " ";
            break;
        case "ArrowDown":
            history(true);
	    break;
        case "ArrowUp":
            history(false);
	    break;
    }
});

output.innerText = "Microsoft Windows [Version 10.0.17763.316]\n(c) 2018 Microsoft Corporation. All rights reserved.\n";

function process(command) {
    tmp = command.split(/>(.*)/);
    path = tmp[0]; // C:\WINDOWS\system32
    args = input.innerText.split(" "); // echo,hello,world 
    displayable = getDisplayable(args, 1);
    switch (args[0].toLowerCase()) {
        case "cls":
            output.innerText = "";
            return false;
            break;
        case "echo":
            if (args.length > 1) {
                return displayable
            } else {
                return "ECHO is on."
            }
            break;
        case "color":
            ColorParser(args);	    
            break;
        case "title":
            if (args.length > 1) {
                document.title = displayable
            }
            break;
        case "cd":
            break;
        default:
            if (!commands.has(args[0])) {
                return "'" + args[0] + "' is not recognized as an internal or external command,\noperable program or batch file.";
            } else {
                return commands.get(args[0]);
            }
    }
}
</script></body></html>
